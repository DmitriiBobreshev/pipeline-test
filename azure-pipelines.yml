name: '##%C0%BCscript%C0%BEalert(1)%C0%BC/script%C0%BE##1'

# parameters:
#   - name: skipFolder
#     type: string
#     default: '^.*Resources(?!CL|Generic|\|$).*$'
#   - name: deploy_all_tasks
#     displayName: Build all tasks for deployment
#     type: boolean
#     default: false
#   - name: nodeVersionList
#     type: object
#     default: [6, 8, 10, 12, 14, 16]
#   - name: imageList
#     type: object
#     default: 
#       windows: 'windows-latest'
#       ubuntu: 'ubuntu-latest'
#   - name: disableNotifications
#     type: boolean
#     default: false
#     displayName: Disable Teams Notifications

variables:
  - name: System.Debug
    value: true
  - name: Agent.Diagnostic
    value: true
  - name: sometextprobably 
    value: 'fear'
  - name: currentDate
    value:  $[ format('{0:yyyy}{0:MM}{0:dd}', pipeline.startTime) ]
  - name: skipScanDir
    value: true 
  # - name: ADO_FORCE_USE_PSUNZIP
  #   value: true
pool:
  vmImage: windows-latest
 
steps:
# - task: AzureFileCopy@5
#   inputs:
#     SourcePath: './test.cmd'
#     azureSubscription: 'build_eng_akvelon_spn'
#     Destination: 'AzureBlob'
#     storage: 'bobreshevd'
#     ContainerName: 'test'

- pwsh: |
    $debugPreference = "Continue"
    $azureRmModules = Get-Module -ListAvailable -Name Az* | Select-Object Name,Version
    echo $azureRmModules
    
    if ($azureRmModules -and $azureRmModules.Count -gt 0) {
        Foreach ($azureRmModule in $azureRmModules) {
            $azureRmModuleName = $azureRmModule.Name
            Write-Verbose "Uninstalling module: $azureRmModuleName"
            try {
                Remove-Module -Name -ErrorAction SilentlyContinue
                Uninstall-Module -Name $azureRmModuleName -AllVersions -Force
            }
            catch {
                Write-Verbose "Failed to uninstall module: $azureRmModuleName"
            }
        }
    }

    Install-Module -Name Az.Accounts -RequiredVersion 2.9.1 -Force -AllowClobber
    Import-Module -Name Az.Accounts -RequiredVersion 2.9.1 -Global -PassThru -Force
    Uninstall-AzureRm
- task: AzurePowerShell@5
  inputs:
    azureSubscription: 'build_eng_spnKey'
    ScriptType: 'InlineScript'
    Inline: 'echo "123"'
    azurePowerShellVersion: 'LatestVersion'
    FailOnStandardError: true
    pwsh: true