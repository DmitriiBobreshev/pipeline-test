parameters:
  - name: skipFolder
    type: string
    default: '^.*Resources(?!CL|Generic|\|$).*$'

variables:
  - name: System.Debug
    value: true
  - name: Agent.Diagnostic
    value: true
pool: #Default
  vmImage: 'windows-latest'

steps:
  - task: TokenizeInArchiveTask@1
    displayName: 'ReplaceToken #[]# in appsettings.test.json'
    inputs:
      PathToArchives: archs\*.zip
      Packages: '*.zip'
      FilesToTokenize: appsettings.test.json
      Prefix: '#['
      Suffix: ']#'
      ReplaceWithEmpty: false
  - task: AzureRmWebAppDeployment@4
    displayName: Webhooks-Legacy
    inputs:
      azureSubscription: 'Build_Eng(3f56da7f-5953-4018-8ca8-e20dbfa0a7e2)'
      appType: webApp
      WebAppName: vbobreshev-test-web-app
      deployToSlotOrASE: true
      ResourceGroupName: vbobreshev-rg
      packageForLinux: archs\*.zip
      xmlVariableSubstitution: True
      enableCustomDeployment: true
      removeAdditionalFilesFlag: True
      takeAppOfflineFlag: True
      appOffline: True
      connectionType: AzureRM
      slotName: production