# resources:


#   repositories:
#   - repository: AzureDevOps
#     type: git
#     endpoint: AzureDevOps
#     name: AzureDevOps/AzureDevOps

variables:
  - name: System.Debug
    value: true
  - name: build.clean
    value: all
  - name: agent.clean.buildDirectory
    value: all
  - name: agent.diagnostic
    value: true
  - name: sourceDir
    value: $(Build.SourcesDirectory)

jobs:
- job: 'Example'
  pool:
    # name: 'Default'
    vmImage: 'windows-latest'
  steps:
    # - task: PackerBuild@0
    #   inputs:
    #     templateType: 'custom'
    #     customTemplateLocation: 'templates/script.ps1'
    #     packerVersion: '1.5.1'
  

    - task: PackerBuild@0
      condition: always()
      inputs:
        templateType: 'builtin'
        ConnectedServiceName: 'CIX_Eng (371d9573-3b58-46e5-8489-aac909ffc94c)'
        # isManagedImage: false
        location: 'westus'
        storageAccountName: 'vbobreshevtestjavatask'
        azureResourceGroup: 'v-bobreshev-rg'
        baseImageSource: 'default'
        baseImage: 'MicrosoftWindowsServer:WindowsServer:2012-R2-Datacenter:windows'
        packagePath: 'templates'
        deployScriptPath: '**/script.ps1'