variables:
  - name: enableAzureResourcesDependentTests # Enable tests that are using Azure resources
    value: true

stages:
- stage: 'Win2017'
  dependsOn: []
  jobs:
  - template: src/javaToolInstaller/templates/java-tool-installer-jobs-template-jdk7.yml
    parameters:
      enableAzureResourcesDependentTests: ${{ variables.enableAzureResourcesDependentTests }}
      pool:
        name: 'Azure Pipelines'
        vmImage: 'vs2017-win2016'

- stage: 'Win2019'
  dependsOn: []
  jobs:
  - template: src/javaToolInstaller/templates/java-tool-installer-jobs-template-jdk7.yml
    parameters:
      enableAzureResourcesDependentTests: ${{ variables.enableAzureResourcesDependentTests }}
      pool:
        name: 'Azure Pipelines'
        vmImage: 'windows-2019'

- stage: 'Win2022'
  dependsOn: []
  jobs:
  - template: src/javaToolInstaller/templates/java-tool-installer-jobs-template-jdk7.yml
    parameters:
      enableAzureResourcesDependentTests: ${{ variables.enableAzureResourcesDependentTests }}
      pool:
        name: 'Azure Pipelines'
        vmImage: 'windows-2022'

- stage: 'ubuntu1804'
  dependsOn: []
  jobs:
  - template: src/javaToolInstaller/templates/java-tool-installer-jobs-template-jdk7.yml
    parameters:
      enableAzureResourcesDependentTests: ${{ variables.enableAzureResourcesDependentTests }}
      pool: $[ coalesce(variables.ubuntu1804, 'Hosted Ubuntu 1804') ]

- ${{ if eq(variables.enableAzureResourcesDependentTests, true) }}:
  - stage: 'MacOs'
    dependsOn: []
    jobs:
    - template: src/javaToolInstaller/templates/java-tool-installer-jobs-template-macos.yml
      parameters:
        pool:
          name: 'Azure Pipelines'
          vmImage: 'macos-10.15'
