steps:

- task: Bash@3
  displayName: 'Set Xamarin & Mono'
  inputs:
    targetType: filePath
    filePath: src/xamarin-ios/select-xamarin.sh
    arguments: ${{ parameters.XAMARIN_SYMLINK }}

- task: Bash@3
  displayName: 'Set Xcode'
  inputs:
    targetType: filePath
    filePath: src/xamarin-ios/select-xcode.sh
    arguments: ${{ parameters.XCODE_VERSION }}

- task: NuGetToolInstaller@1

- task: NuGetCommand@2
  inputs:
    restoreSolution: '$(build.sourcesdirectory)/src/xamarin-ios/UsingUITest/UsingUITest.sln'

- task: XamariniOS@2
  displayName: 'Build Xamarin.iOS solution UsingUITest.sln'
  inputs:
    solutionFile: '$(build.sourcesdirectory)/src/xamarin-ios/UsingUITest/UsingUITest.sln'
    configuration: Release
    packageApp: False
    buildForSimulator: True
    runNugetRestore: false
    buildToolOption: msbuild
  retryCountOnTaskFailure: 3